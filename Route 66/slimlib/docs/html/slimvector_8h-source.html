<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Slim Library: slimvector.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>slimvector.h</h1><pre class="fragment"><div>00001 <span class="preprocessor">#ifndef __SLIMVECTOR__</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define __SLIMVECTOR__                                                                                                       </span>
00003 <span class="preprocessor"></span>
00004 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00005 <span class="preprocessor">#include &lt;string.h&gt;</span>
00006 
00007 <span class="preprocessor">#define SLIMVECTOR_NOERROR      0</span>
00008 <span class="preprocessor"></span><span class="preprocessor">#define SLIMVECTOR_OUTOFMEMORY  1</span>
00009 <span class="preprocessor"></span><span class="preprocessor">#define SLIMVECTOR_ENDOFVECTOR  2</span>
00010 <span class="preprocessor"></span>
00011 
00012 
00013 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span>VectorItem
00014 {
00015     <span class="keyword">private</span>:
00016         VectorItem *prev;
00017         VectorItem *next;
00018         T *content;
00019         <span class="keywordtype">int</span> lastError;
00020       
00021     <span class="keyword">public</span>:
00022         VectorItem(VectorItem *prev, VectorItem *next, T content)
00023         {
00024            lastError = SLIMVECTOR_NOERROR;
00025            this-&gt;prev = prev;
00026            this-&gt;next = next;
00027            <span class="keywordflow">if</span>((this-&gt;content = (T*) malloc(<span class="keyword">sizeof</span>(T))) == NULL)
00028            {
00029                 lastError = SLIMVECTOR_OUTOFMEMORY;
00030            }
00031            <span class="keywordflow">else</span>
00032            {
00033                 memcpy(this-&gt;content, &amp;content, <span class="keyword">sizeof</span>(T));
00034            }
00035         }   
00036         
00037         
00038         
00039         VectorItem(VectorItem *prev, VectorItem *next, T *content)
00040         {
00041             this-&gt;prev = prev;
00042             this-&gt;next = next;
00043             this-&gt;content = content;
00044         } 
00045         
00046         
00047         
00048         <span class="keywordtype">void</span> setNext(VectorItem *next)
00049         {
00050            this-&gt;next = next;
00051         }      
00052           
00053           
00054         
00055         <span class="keywordtype">void</span> setPrev(VectorItem *prev)
00056         {
00057            this-&gt;prev = prev;
00058         }  
00059             
00060              
00061         
00062         VectorItem *getNext(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
00063 <span class="keyword">        </span>{
00064             <span class="keywordflow">return</span> next;
00065         }
00066         
00067         
00068         
00069         VectorItem *getPrev(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
00070 <span class="keyword">        </span>{
00071            <span class="keywordflow">return</span> prev;
00072         }
00073         
00074         
00075         
00076         T getContent(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
00077 <span class="keyword">        </span>{
00078            <span class="keywordflow">return</span> *content;
00079         }        
00080         
00081         
00082         
00083         T* getPointerOnContent(<span class="keywordtype">void</span>)
00084         {
00085            <span class="keywordflow">return</span> content;
00086         }        
00087         
00088         
00089         
00090         ~VectorItem(<span class="keywordtype">void</span>)
00091         {
00092             
00093         }
00094         
00095         
00096         
00097         <span class="keywordtype">int</span> getLastError(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
00098 <span class="keyword">        </span>{
00099             <span class="keywordflow">return</span> lastError;
00100         }        
00101 };
00102 
00103 
00104 
<a name="l00109"></a><a class="code" href="classSlimVector.html">00109</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span><a class="code" href="classSlimVector.html">SlimVector</a>
00110 {
00111     <span class="keyword">protected</span>:
00112         
00113        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nbItems;
00114        VectorItem&lt;T&gt; *firstItem;
00115        VectorItem&lt;T&gt; *lastItem;
00116        VectorItem&lt;T&gt; *readingCursor;
00117        <span class="keywordtype">int</span> lastError;
00118        
00119        
00120        
00121        <span class="keywordtype">void</span> g_push(VectorItem&lt;T&gt; *item)
00122        {
00123             <span class="keywordflow">if</span>(item != NULL)
00124                 {
00125                         <span class="keywordflow">if</span>(nbItems == 0) firstItem = item;
00126                         <span class="keywordflow">else</span> lastItem-&gt;setNext(item);
00127                         lastItem = item;
00128                         nbItems++;
00129                 }
00130        }
00131        
00132        
00133        
00134        VectorItem&lt;T&gt; *g_pop(<span class="keywordtype">void</span>)
00135        {
00136             VectorItem&lt;T&gt; *item;
00137             
00138             <span class="keywordflow">if</span>(lastItem == NULL) 
00139             {
00140                 <span class="keywordflow">return</span> NULL;
00141             }
00142             
00143             item = lastItem-&gt;getPrev();
00144             <span class="keywordflow">if</span>(item == NULL) firstItem = NULL; 
00145             <span class="keywordflow">else</span> item-&gt;setNext(NULL);
00146             nbItems--;
00147             item = lastItem;
00148             lastItem = item-&gt;getPrev();
00149             
00150             <span class="keywordflow">return</span> item;
00151        }
00152        
00153        
00154        
00155        <span class="keywordtype">void</span> g_erase(VectorItem&lt;T&gt; *item)
00156        {
00157             VectorItem&lt;T&gt; *prev;
00158             VectorItem&lt;T&gt; *next;
00159             
00160             prev = item-&gt;getPrev();
00161             next = item-&gt;getNext();
00162             
00163             <span class="keywordflow">if</span>(prev != NULL) 
00164             {
00165                 prev-&gt;setNext(next);
00166             }
00167             <span class="keywordflow">else</span> 
00168             {
00169                 firstItem = next;
00170             }
00171             
00172             <span class="keywordflow">if</span>(next != NULL)
00173             {
00174                 next-&gt;setPrev(prev);
00175             }
00176             <span class="keywordflow">else</span> 
00177             {
00178                 lastItem = prev;
00179             }
00180             
00181             <span class="keyword">delete</span> item;
00182             nbItems--;
00183        }
00184        
00185        
00186        
00187     <span class="keyword">public</span>:
00188                 <a class="code" href="classSlimVector.html">SlimVector</a>(<span class="keywordtype">void</span>)
00189         {
00190             <a class="code" href="classSlimVector.html#a2">clear</a>();
00191             lastError = SLIMVECTOR_NOERROR;
00192         }       
00193         
00194         
00195         
00196             <span class="keywordtype">int</span> getLastError(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
00197 <span class="keyword">        </span>{
00198             <span class="keywordflow">return</span> lastError;
00199         }        
00200         
00201         
00202           
<a name="l00207"></a><a class="code" href="classSlimVector.html#a2">00207</a>                 <span class="keywordtype">void</span> <a class="code" href="classSlimVector.html#a2">clear</a>(<span class="keywordtype">void</span>)
00208         {
00209                 nbItems = 0;
00210                 firstItem = NULL;
00211                 lastItem = NULL;
00212         }
00213 
00214 
00215 
<a name="l00220"></a><a class="code" href="classSlimVector.html#a3">00220</a>         <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classSlimVector.html#a3">size</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
00221 <span class="keyword">        </span>{
00222             <span class="keywordflow">return</span> nbItems;
00223         }
00224 
00225 
00226 
<a name="l00232"></a><a class="code" href="classSlimVector.html#a4">00232</a>         <span class="keywordtype">int</span> push(T o)
00233         {
00234             VectorItem&lt;T&gt; *item = <span class="keyword">new</span> VectorItem&lt;T&gt;(lastItem, NULL, o);
00235             g_push(item);
00236             
00237             <span class="keywordflow">return</span> item-&gt;getLastError();                
00238         }        
00239           
00240         
00241         
<a name="l00247"></a><a class="code" href="classSlimVector.html#a5">00247</a>         <span class="keywordtype">int</span> push(T *o)
00248         {
00249             VectorItem&lt;T&gt; *item = <span class="keyword">new</span> VectorItem&lt;T&gt;(lastItem, NULL, o);
00250                 g_push(item);
00251             
00252             <span class="keywordflow">return</span> item-&gt;getLastError();
00253         }      
00254       
00255       
00256       
<a name="l00263"></a><a class="code" href="classSlimVector.html#a6">00263</a>         T <a class="code" href="classSlimVector.html#a6">pop</a>(<span class="keywordtype">void</span>)
00264         {
00265             VectorItem&lt;T&gt; *item = g_pop();
00266             
00267             <span class="keywordflow">if</span>(item == NULL)
00268             {
00269                 T o;
00270                 lastError = SLIMVECTOR_ENDOFVECTOR;
00271                 <span class="keywordflow">return</span> o;
00272             }
00273             
00274             <span class="keywordflow">return</span> item-&gt;getContent();
00275         }
00276         
00277         
00278                 
<a name="l00284"></a><a class="code" href="classSlimVector.html#a7">00284</a>         T *<a class="code" href="classSlimVector.html#a7">pop_reference</a>(<span class="keywordtype">void</span>)
00285         {
00286             VectorItem&lt;T&gt; *item = g_pop();
00287             
00288             <span class="keywordflow">if</span>(item == NULL)
00289             {
00290                 <span class="keywordflow">return</span> NULL;
00291             }
00292             
00293             <span class="keywordflow">return</span> item-&gt;getPointerOnContent();
00294         }
00295         
00296         
00297                 
<a name="l00302"></a><a class="code" href="classSlimVector.html#a8">00302</a>         <span class="keywordtype">void</span> erase(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x)
00303         {
00304             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;
00305             VectorItem&lt;T&gt; *item = firstItem;
00306             
00307             <span class="keywordflow">while</span>(item != NULL)
00308             {
00309                 <span class="keywordflow">if</span>(x == i) 
00310                 {
00311                         g_erase(item);
00312                     <span class="keywordflow">return</span>;
00313                 }
00314                 
00315                 i++;
00316                 item = item-&gt;getNext();
00317             }
00318         }
00319         
00320         
00321         
<a name="l00330"></a><a class="code" href="classSlimVector.html#a9">00330</a>         <span class="keywordtype">void</span> <a class="code" href="classSlimVector.html#a9">eraseItemAtReadingCursor</a>(<span class="keywordtype">void</span>)
00331         {
00332             VectorItem&lt;T&gt; *curr;
00333             
00334                 <span class="keywordflow">if</span>(readingCursor == NULL)
00335                 {
00336                         curr = lastItem;
00337                 }
00338                 <span class="keywordflow">else</span>
00339                 {
00340                         curr = readingCursor-&gt;getPrev();
00341                 }
00342                 
00343                 <span class="keywordflow">if</span>(curr == NULL)
00344                 {
00345                         curr = readingCursor;
00346                 }
00347                 
00348                 g_erase(curr);
00349         }        
00350         
00351         
00352         
<a name="l00358"></a><a class="code" href="classSlimVector.html#a10">00358</a>                 T operator[](<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x)<span class="keyword"> const</span>
00359 <span class="keyword">        </span>{
00360                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;
00361                 VectorItem&lt;T&gt; *item = firstItem;
00362                         
00363                 <span class="keywordflow">while</span>(item != NULL)
00364                 {
00365                         <span class="keywordflow">if</span>(x == i) 
00366                         {
00367                        <span class="keywordflow">return</span> item-&gt;getContent();
00368                         }
00369                         
00370                         i++;
00371                         item = item-&gt;getNext();
00372                 }
00373         }
00374 
00375 
00376 
<a name="l00381"></a><a class="code" href="classSlimVector.html#a11">00381</a>                 T <a class="code" href="classSlimVector.html#a11">getLastItem</a>(<span class="keywordtype">void</span>)    
00382         {
00383                 <span class="keywordflow">return</span> lastItem-&gt;getContent();
00384         }
00385         
00386         
00387         
<a name="l00392"></a><a class="code" href="classSlimVector.html#a12">00392</a>                 T *<a class="code" href="classSlimVector.html#a12">getPointerOnLastItem</a>(<span class="keywordtype">void</span>)    
00393         {
00394                 <span class="keywordflow">if</span>(lastItem == NULL)
00395                 {
00396                 <span class="keywordflow">return</span> NULL;
00397             }
00398             
00399             <span class="keywordflow">return</span> lastItem-&gt;getPointerOnContent();
00400         }                   
00401        
00402        
00403        
<a name="l00409"></a><a class="code" href="classSlimVector.html#a13">00409</a>                 T* getPointerOnItem(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x)
00410         {
00411                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;
00412                 VectorItem&lt;T&gt; *item = firstItem;
00413         
00414                 <span class="keywordflow">while</span>(item != NULL)
00415                 {
00416                         <span class="keywordflow">if</span>(x == i) 
00417                         {
00418                                 <span class="keywordflow">return</span> item-&gt;getPointerOnContent();
00419                         }
00420                         
00421                         i++;
00422                         item = item-&gt;getNext();
00423                 }
00424         }               
00425                 
00426                 
00427                 
<a name="l00434"></a><a class="code" href="classSlimVector.html#a14">00434</a>                 <span class="keywordtype">void</span> <a class="code" href="classSlimVector.html#a14">beginSequentialReading</a>(<span class="keywordtype">void</span>)
00435         {
00436             readingCursor = firstItem;
00437         }
00438         
00439         
00440         
<a name="l00445"></a><a class="code" href="classSlimVector.html#a15">00445</a>         T* <a class="code" href="classSlimVector.html#a15">readItemPointer</a>(<span class="keywordtype">void</span>)
00446         {
00447             T* o;
00448             <span class="keywordflow">if</span>(readingCursor == NULL) <span class="keywordflow">return</span> NULL;
00449             o = readingCursor-&gt;getPointerOnContent();
00450             readingCursor = readingCursor-&gt;getNext();
00451             <span class="keywordflow">return</span> o;
00452         }        
00453         
00454         
00455         
<a name="l00460"></a><a class="code" href="classSlimVector.html#a16">00460</a>         T <a class="code" href="classSlimVector.html#a16">readItem</a>(<span class="keywordtype">void</span>)
00461         {
00462             T o;
00463             <span class="keywordflow">if</span>(readingCursor == NULL) 
00464             {
00465                 lastError = SLIMVECTOR_ENDOFVECTOR;
00466                 <span class="keywordflow">return</span> o;
00467             }
00468             o = readingCursor-&gt;getContent();
00469             readingCursor = readingCursor-&gt;getNext();
00470             <span class="keywordflow">return</span> o;
00471         }
00472         
00473         
00474         
<a name="l00479"></a><a class="code" href="classSlimVector.html#a17">00479</a>         <span class="keywordtype">bool</span> <a class="code" href="classSlimVector.html#a17">isEndOfVector</a>(<span class="keywordtype">void</span>)
00480         {
00481                 <span class="keywordflow">if</span>(readingCursor == NULL) <span class="keywordflow">return</span> <span class="keyword">true</span>;
00482                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00483         }        
00484         
00485         
00486         
<a name="l00490"></a><a class="code" href="classSlimVector.html#a18">00490</a>                 <a class="code" href="classSlimVector.html#a18">~SlimVector</a> ()
00491         {
00492                 VectorItem&lt;T&gt; *temp;
00493                 VectorItem&lt;T&gt; *item = firstItem;
00494          
00495                  <span class="keywordflow">while</span>(item != NULL)
00496                  {
00497                  temp = item-&gt;getNext();
00498                  <span class="keyword">delete</span> item;
00499                  item = temp;
00500                  }
00501         }
00502 };
00503 <span class="preprocessor">#endif</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Wed Apr 6 16:05:40 2005 for Slim Library by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
