<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Slim Library: slimsocket.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>slimsocket.h</h1><pre class="fragment"><div>00001 <span class="comment">/*</span>
00002 <span class="comment">    Slimsocket for Posix compliant OS</span>
00003 <span class="comment">    Cross-Platform Portable Library for socket networking programming</span>
00004 <span class="comment">*/</span>
00005 
00006 <span class="preprocessor">#ifndef _SLIMSOCKET_</span>
00007 <span class="preprocessor"></span><span class="preprocessor">#define _SLIMSOCKET_</span>
00008 <span class="preprocessor"></span>
00009 <span class="preprocessor">#if defined(unix) || defined(__APPLE__)</span>
00010 <span class="preprocessor"></span><span class="preprocessor">        #include &lt;sys/types.h&gt;</span>
00011 <span class="preprocessor">        #include &lt;sys/socket.h&gt;</span>
00012 <span class="preprocessor">        #include &lt;netinet/in.h&gt;</span>
00013 <span class="preprocessor">        #include &lt;arpa/inet.h&gt;</span>
00014 <span class="preprocessor">        #include &lt;netdb.h&gt;</span>
00015 <span class="preprocessor">        #include &lt;unistd.h&gt;</span>
00016         
00017 <span class="preprocessor">        #define SOCKET int</span>
00018 <span class="preprocessor"></span><span class="preprocessor">        #define SOCKADDR_IN struct sockaddr_in</span>
00019 <span class="preprocessor"></span><span class="preprocessor">        #define INVALID_SOCKET 0</span>
00020 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00021 <span class="preprocessor"></span>
00022 <span class="preprocessor">#ifdef WIN32</span>
00023 <span class="preprocessor"></span><span class="preprocessor">        #include &lt;winsock.h&gt;</span>
00024 <span class="preprocessor">#endif</span>
00025 <span class="preprocessor"></span>
00026 <span class="preprocessor">#ifdef _WIN32_WCE</span>
00027 <span class="preprocessor"></span><span class="preprocessor">        #include &lt;Afxsock.h&gt;</span>
00028 <span class="preprocessor">#endif</span>
00029 <span class="preprocessor"></span>
00030 <span class="preprocessor">#ifdef __APPLE__</span>
00031 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00032 <span class="preprocessor"></span>
00033 <span class="preprocessor">#if defined(WIN32) || defined(_WIN32_WCE)</span>
00034 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00035 <span class="preprocessor"></span>
00036 <span class="preprocessor">#if defined(WIN32) || defined(_WIN32_WCE) || defined(__APPLE__)</span>
00037 <span class="preprocessor"></span>    <span class="keyword">typedef</span> <span class="keywordtype">int</span> socklen_t;
00038 <span class="preprocessor">#endif</span>
00039 <span class="preprocessor"></span>
00040 <span class="preprocessor">#define SLIMSOCKET_DEFAULT_BUFFER_SIZE  20480    //default buffer size: 20 ko</span>
00041 <span class="preprocessor"></span><span class="preprocessor">#define SLIMSOCKET_DEFAULT_MULTICAST_TTL    1    //default ttl do not pass through routers</span>
00042 <span class="preprocessor"></span><span class="preprocessor">#define SLIMSOCKET_BACKLOG                 20    // a TCP server socket is able to enqueue 20 pending connections from clients</span>
00043 <span class="preprocessor"></span><span class="preprocessor">#define SLIMSOCKET_IP_LENGTH               16    // an IP address is xxx.xxx.xxx.xxx\0</span>
00044 <span class="preprocessor"></span><span class="preprocessor">#define SLIMSOCKET_LOCAL_NAME_LENGTH      256</span>
00045 <span class="preprocessor"></span>
00046 <span class="preprocessor">#define SLIMSOCKET_NOERROR                  0</span>
00047 <span class="preprocessor"></span><span class="preprocessor">#define SLIMSOCKET_NO_PORT_DEFINED          1</span>
00048 <span class="preprocessor"></span><span class="preprocessor">#define SLIMSOCKET_NO_GROUP_DEFINED         2</span>
00049 <span class="preprocessor"></span><span class="preprocessor">#define SLIMSOCKET_ALLOCATING_FAILED        3</span>
00050 <span class="preprocessor"></span><span class="preprocessor">#define SLIMSOCKET_BINDING_FAILED           4</span>
00051 <span class="preprocessor"></span><span class="preprocessor">#define SLIMSOCKET_JOINING_FAILED           5</span>
00052 <span class="preprocessor"></span><span class="preprocessor">#define SLIMSOCKET_RECEPTION_FAILED         -1</span>
00053 <span class="preprocessor"></span><span class="preprocessor">#define SLIMSOCKET_REUSEADDR_FAILED         7</span>
00054 <span class="preprocessor"></span><span class="preprocessor">#define SLIMSOCKET_REUSEPORT_FAILED         8</span>
00055 <span class="preprocessor"></span><span class="preprocessor">#define SLIMSOCKET_TTL_SETTING_FAILED       9</span>
00056 <span class="preprocessor"></span><span class="preprocessor">#define SLIMSOCKET_SENDDATA_FAILED          10</span>
00057 <span class="preprocessor"></span><span class="preprocessor">#define SLIMSOCKET_CONNECTION_FAILED        11</span>
00058 <span class="preprocessor"></span><span class="preprocessor">#define SLIMSOCKET_ACCEPT_FAILED            12</span>
00059 <span class="preprocessor"></span><span class="preprocessor">#define SLIMSOCKET_LISTENING_FAILED         13</span>
00060 <span class="preprocessor"></span>
00061 
00062 
<a name="l00073"></a><a class="code" href="classSlimSocket.html">00073</a> <span class="keyword">class </span><a class="code" href="classSlimSocket.html">SlimSocket</a>
00074 {
00075     <span class="keyword">protected</span>:
00076                 SOCKET socket_handle ;
00077 
00078         <span class="keyword">struct </span>ip_mreq mreq;            <span class="comment">// Used in adding or dropping</span>
00079         <span class="keywordtype">char</span> *buffer;
00080         <span class="keywordtype">int</span> buffer_size;
00081         <span class="keywordtype">bool</span> resize_buffer_allowed;
00082 
00083     <span class="keyword">public</span>:
00084        <a class="code" href="classSlimSocket.html">SlimSocket</a>(<span class="keywordtype">void</span>);
00085        ~<a class="code" href="classSlimSocket.html">SlimSocket</a>(<span class="keywordtype">void</span>);
00086        <span class="keywordtype">bool</span> resizeReceptionBuffer(<span class="keywordtype">int</span> size);
00087        <span class="keywordtype">void</span> closeSocket(<span class="keywordtype">void</span>);
00088 };
00089 
00090 
00091 
00092 
<a name="l00101"></a><a class="code" href="classSlimTcpSocket.html">00101</a> <span class="keyword">class </span><a class="code" href="classSlimTcpSocket.html">SlimTcpSocket</a>: <span class="keyword">public</span> <a class="code" href="classSlimSocket.html">SlimSocket</a>
00102 {
00103     <span class="keyword">public</span>:
00104         <a class="code" href="classSlimTcpSocket.html">SlimTcpSocket</a>(<span class="keywordtype">void</span>);
00105         <span class="keywordtype">void</span> setHandle(<span class="keywordtype">int</span> handle);
00106         <span class="keywordtype">int</span> sendData(<span class="keywordtype">int</span> handle, <span class="keyword">const</span> <span class="keywordtype">char</span> *buffer, <span class="keywordtype">int</span> nbByteToSend);
00107         <span class="keywordtype">int</span> sendData(<span class="keyword">const</span> <span class="keywordtype">char</span> *buffer, <span class="keywordtype">int</span> nbByteToSend);
00108         <span class="keywordtype">int</span> waitingForData(<span class="keywordtype">int</span> handle, <span class="keywordtype">char</span> *buffer);
00109         <span class="keywordtype">int</span> waitingForData(<span class="keywordtype">char</span> *buffer);
00110 };
00111 
00112 
00113 
00114 
<a name="l00121"></a><a class="code" href="classSlimTcpConnectionHandler.html">00121</a> <span class="keyword">class </span><a class="code" href="classSlimTcpConnectionHandler.html">SlimTcpConnectionHandler</a>
00122 {
00123     <span class="keyword">protected</span>:
00124         <a class="code" href="classSlimTcpSocket.html">SlimTcpSocket</a> socket;
00125 
00126     <span class="keyword">public</span>:
00127         <a class="code" href="classSlimTcpConnectionHandler.html">SlimTcpConnectionHandler</a>() { }
00128         <span class="keyword">virtual</span> ~<a class="code" href="classSlimTcpConnectionHandler.html">SlimTcpConnectionHandler</a>() { }
00129 
00130 
00131 
00138         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classSlimTcpConnectionHandler.html#a2">onConnection</a>(<span class="keywordtype">int</span> handle);
00139 };
00140 
00141 
00142 
00143 
<a name="l00147"></a><a class="code" href="classSlimTcpServerSocket.html">00147</a> <span class="keyword">class </span><a class="code" href="classSlimTcpServerSocket.html">SlimTcpServerSocket</a>: <span class="keyword">public</span> <a class="code" href="classSlimTcpSocket.html">SlimTcpSocket</a>
00148 {
00149         <span class="keyword">protected</span>:
00150             <span class="keywordtype">int</span> server_stopped;
00151 
00152 <span class="preprocessor">                        #if defined (unix) || defined (__APPLE__)</span>
00153 <span class="preprocessor"></span>            <span class="keyword">struct </span>sockaddr_in local_sin;
00154 <span class="preprocessor">                        #endif</span>
00155 <span class="preprocessor"></span>
00156 <span class="preprocessor">                        #ifdef WIN32</span>
00157 <span class="preprocessor"></span>                        SOCKADDR_IN local_sin;
00158 <span class="preprocessor">                        #endif</span>
00159 <span class="preprocessor"></span>
00160             <span class="keywordtype">int</span> port;
00161             <a class="code" href="classSlimTcpConnectionHandler.html">SlimTcpConnectionHandler</a> *connection_handler;
00162 
00163         <span class="keyword">public</span>:
00164 
00169            <a class="code" href="classSlimTcpServerSocket.html">SlimTcpServerSocket</a>(<span class="keywordtype">int</span> port);
00170            ~<a class="code" href="classSlimTcpServerSocket.html">SlimTcpServerSocket</a>(<span class="keywordtype">void</span>) { }
00171 
00172 
00173 
00178            <span class="keywordtype">void</span> <a class="code" href="classSlimTcpServerSocket.html#a2">setConnectionHandler</a>(<a class="code" href="classSlimTcpConnectionHandler.html">SlimTcpConnectionHandler</a> *connection_handler);
00179 
00180 
00181 
00186            <span class="keywordtype">int</span> <a class="code" href="classSlimTcpServerSocket.html#a3">start</a>(<span class="keywordtype">void</span>);
00187 };
00188 
00189 
00190 
00191 
00192 
<a name="l00196"></a><a class="code" href="classSlimTcpClientSocket.html">00196</a> <span class="keyword">class </span><a class="code" href="classSlimTcpClientSocket.html">SlimTcpClientSocket</a>: <span class="keyword">public</span> <a class="code" href="classSlimTcpSocket.html">SlimTcpSocket</a>
00197 {
00198     <span class="keyword">protected</span>:
00199 <span class="preprocessor">                #if defined (unix) || defined (__APPLE__)</span>
00200 <span class="preprocessor"></span>        <span class="keyword">struct </span>sockaddr_in server_sin;
00201 <span class="preprocessor">                #endif</span>
00202 <span class="preprocessor"></span>
00203 <span class="preprocessor">                #ifdef WIN32</span>
00204 <span class="preprocessor"></span>                SOCKADDR_IN server_sin;
00205 <span class="preprocessor">                #endif</span>
00206 <span class="preprocessor"></span>
00207     <span class="keyword">public</span>:
00208         <a class="code" href="classSlimTcpClientSocket.html">SlimTcpClientSocket</a>(<span class="keywordtype">void</span>);
00209 
00215         <span class="keywordtype">int</span> <a class="code" href="classSlimTcpClientSocket.html#a1">getConnectionTo</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *ip, <span class="keywordtype">int</span> port);
00216 
00217 
00218 
00228         <span class="keywordtype">int</span> <a class="code" href="classSlimTcpClientSocket.html#a2">sendData</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *buffer, <span class="keywordtype">int</span> nbByteToSend);
00229 
00230 
00231 
00237         <span class="keywordtype">int</span> <a class="code" href="classSlimTcpClientSocket.html#a3">waitingForData</a>(<span class="keywordtype">char</span> *buffer);
00238 
00239 };
00240 
00241 
00242 
<a name="l00246"></a><a class="code" href="classSlimUdpSocket.html">00246</a> <span class="keyword">class </span><a class="code" href="classSlimUdpSocket.html">SlimUdpSocket</a>: <span class="keyword">public</span> <a class="code" href="classSlimSocket.html">SlimSocket</a>
00247 {
00248     <span class="keyword">protected</span>:
00249         <span class="keywordtype">int</span> port;
00250                 SOCKADDR_IN local_sin;          <span class="comment">// Local socket's address</span>
00251         SOCKADDR_IN dest_sin;           <span class="comment">// Recipient socket's address</span>
00252 
00253     <span class="keyword">public</span>:
00254 
00260         <a class="code" href="classSlimUdpSocket.html#a0">SlimUdpSocket</a>(<span class="keywordtype">void</span>);
00261 
00262 
00263 
00268         <a class="code" href="classSlimUdpSocket.html#a0">SlimUdpSocket</a>(<span class="keywordtype">int</span> port);
00269 
00270 
00276         <span class="keywordtype">int</span> <a class="code" href="classSlimUdpSocket.html#a2">open</a>(<span class="keywordtype">void</span>);
00277 
00278 
00279 
00286         <span class="keywordtype">int</span> <a class="code" href="classSlimUdpSocket.html#a2">open</a>(<span class="keywordtype">int</span> port);
00287 
00288 
00289 
00296         <span class="keywordtype">void</span> <a class="code" href="classSlimUdpSocket.html#a4">setRecipientAddress</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *ip, <span class="keywordtype">int</span> port);
00297 
00298 
00299 
00305         <span class="keywordtype">int</span> <a class="code" href="classSlimUdpSocket.html#a5">waitingForData</a>(<span class="keywordtype">char</span> *buffer);
00306 
00307 
00308 
00315         <span class="keywordtype">int</span> <a class="code" href="classSlimUdpSocket.html#a6">sendData</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *buffer, <span class="keywordtype">int</span> nbByteToSend);
00316 
00317 
00318 
00327         <span class="keywordtype">int</span> sendData(<span class="keyword">const</span> <span class="keywordtype">char</span> *ip, <span class="keywordtype">int</span> port, <span class="keyword">const</span> <span class="keywordtype">char</span> *buffer, <span class="keywordtype">int</span> nbByteToSend);
00328 };
00329 
00330 
00331 
<a name="l00335"></a><a class="code" href="classSlimMulticastSocket.html">00335</a> <span class="keyword">class </span><a class="code" href="classSlimMulticastSocket.html">SlimMulticastSocket</a>: <span class="keyword">public</span> <a class="code" href="classSlimUdpSocket.html">SlimUdpSocket</a>
00336 {
00337     <span class="keyword">protected</span>:
00338         in_addr group_ip;
00339 
00340     <span class="keyword">public</span>:
00341 
00347         <a class="code" href="classSlimMulticastSocket.html#a0">SlimMulticastSocket</a>(<span class="keywordtype">void</span>);
00348 
00349 
00350 
00357         <a class="code" href="classSlimMulticastSocket.html#a0">SlimMulticastSocket</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *group, <span class="keywordtype">int</span> port);
00358 
00359 
00360 
00366         <span class="keywordtype">int</span> <a class="code" href="classSlimMulticastSocket.html#a2">open</a>(<span class="keywordtype">void</span>);
00367 
00368 
00369 
00374         <span class="keywordtype">int</span> <a class="code" href="classSlimMulticastSocket.html#a2">open</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *group, <span class="keywordtype">int</span> port);
00375 };
00376 
00377 
00378 <span class="keywordtype">char</span> *slimGetHostIp(<span class="keyword">const</span> <span class="keywordtype">char</span> *hostname);
00379 <span class="keywordtype">char</span> *slimGetLocalIp(<span class="keywordtype">void</span>);
00380 
00381 <span class="preprocessor">#endif</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Wed Apr 6 16:05:40 2005 for Slim Library by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
